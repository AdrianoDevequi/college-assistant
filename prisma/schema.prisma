generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model studentprofile {
  id           String               @id
  userId       String               @unique(map: "StudentProfile_userId_key")
  phone        String
  level        studentprofile_level @default(A1)
  interestArea String?
  user         user                 @relation(fields: [userId], references: [id], onDelete: Cascade, map: "StudentProfile_userId_fkey")
}

model studenttask {
  id          String    @id
  studentId   String
  taskId      String
  status      String    @default("PENDING")
  sentAt      DateTime  @default(now())
  completedAt DateTime?
  answers     String?   @db.Text
  user        user      @relation(fields: [studentId], references: [id], map: "StudentTask_studentId_fkey")
  task        task      @relation(fields: [taskId], references: [id], map: "StudentTask_taskId_fkey")

  @@index([studentId], map: "StudentTask_studentId_fkey")
  @@index([taskId], map: "StudentTask_taskId_fkey")
}

model systemsettings {
  key   String @id
  value String @db.Text
}

model task {
  id          String           @id
  theme       String
  targetLevel task_targetLevel
  content     String           @db.Text
  generatedAt DateTime         @default(now())
  studenttask studenttask[]
}

model taskautomation {
  id        String               @id
  theme     String
  level     taskautomation_level
  frequency String               @default("WEEKLY")
  nextRun   DateTime             @default(now())
  active    Boolean              @default(true)
  createdAt DateTime             @default(now())
  updatedAt DateTime
  dayOfWeek Int                  @default(1)
  timeOfDay String               @default("09:00")
}

model user {
  id             String          @id
  name           String?
  email          String          @unique(map: "User_email_key")
  password       String
  role           user_role       @default(STUDENT)
  createdAt      DateTime        @default(now())
  updatedAt      DateTime
  studentprofile studentprofile?
  studenttask    studenttask[]
}

enum task_targetLevel {
  A1
  A2
  B1
  B2
  C1
  C2
}

enum taskautomation_level {
  A1
  A2
  B1
  B2
  C1
  C2
}

enum studentprofile_level {
  A1
  A2
  B1
  B2
  C1
  C2
}

enum user_role {
  STUDENT
  ADMIN
}
